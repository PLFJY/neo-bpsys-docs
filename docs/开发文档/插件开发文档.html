<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>neo-bpsys-wpf æ’ä»¶å¼€å‘æŒ‡å—ï¼ˆAIç”Ÿæˆï¼‰ | neo-bpsys Docs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="neo-bpsys-wpf æ’ä»¶å¼€å‘æŒ‡å—ï¼ˆAIç”Ÿæˆï¼‰ | neo-bpsys Docs ">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/PLFJY/neo-bpsys-docs/blob/master/docs/å¼€å‘æ–‡æ¡£/æ’ä»¶å¼€å‘æ–‡æ¡£.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../images/favicon.ico" alt="neo-bpsys-wpf">
            neo-bpsys-wpf
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">

<p><a href="https://github.com/PLFJY/neo-bpsys-wpf/">neo-bpsys-wpf</a>çš„æ’ä»¶ SDK</p>
<h1 id="neo-bpsys-wpf-æ’ä»¶å¼€å‘æŒ‡å—aiç”Ÿæˆ">neo-bpsys-wpf æ’ä»¶å¼€å‘æŒ‡å—ï¼ˆAIç”Ÿæˆï¼‰</h1>
<hr>
<p>æ¬¢è¿ä½¿ç”¨ neo-bpsys-wpf æ’ä»¶ç³»ç»Ÿï¼æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å¿«é€Ÿå¼€å§‹å¼€å‘è‡ªå·±çš„æ’ä»¶ã€‚</p>
<hr>
<h2 id="å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</h2>
<h3 id="1-åˆ›å»ºæ–°é¡¹ç›®">1. åˆ›å»ºæ–°é¡¹ç›®</h3>
<p>åˆ›å»ºä¸€ä¸ªæ–°çš„ .NET WPF ç±»åº“é¡¹ç›®ï¼Œå¹¶å¼•ç”¨Â <code>neo-bpsys-wpf.PluginSdk</code>:</p>
<pre><code class="lang-xml">&lt;ItemGroup&gt;
  &lt;PackageReference Include=&quot;neo-bpsys-wpf.PluginSdk&quot; Version=&quot;2.0.0&quot; /&gt;
&lt;/ItemGroup&gt;
</code></pre>
<h3 id="2-åˆ›å»ºæ’ä»¶æ¸…å•æ–‡ä»¶">2. åˆ›å»ºæ’ä»¶æ¸…å•æ–‡ä»¶</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºÂ <code>manifest.yml</code>Â æ–‡ä»¶ï¼š</p>
<pre><code class="lang-yaml">id: your.unique.plugin.id
name: ä½ çš„æ’ä»¶åç§°
description: æ’ä»¶åŠŸèƒ½æè¿°
entranceAssembly: &quot;YourPlugin.dll&quot;
url: https://github.com/yourusername/yourplugin
version: 1.0.0.0
apiVersion: 2.0.0.0
author: ä½ çš„åå­—
icon: icon.png
</code></pre>
<h3 id="3-åˆ›å»ºæ’ä»¶å…¥å£ç±»">3. åˆ›å»ºæ’ä»¶å…¥å£ç±»</h3>
<p>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªÂ <code>PluginBase</code>Â çš„ç±»ï¼š</p>
<pre><code class="lang-cs">using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using neo_bpsys_wpf.Core.Abstractions;

namespace YourPlugin;

public class Plugin : PluginBase
{
    public override void Initialize(HostBuilderContext context, IServiceCollection services)
    {
        // åœ¨è¿™é‡Œæ³¨å†Œæ’ä»¶çš„å„é¡¹åŠŸèƒ½
    }
}
</code></pre>
<hr>
<h2 id="æ’ä»¶ç»“æ„">æ’ä»¶ç»“æ„</h2>
<p>ä¸€ä¸ªæ ‡å‡†çš„æ’ä»¶é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code>YourPlugin/
â”œâ”€â”€ manifest.yml          # æ’ä»¶æ¸…å•æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ icon.png             # æ’ä»¶å›¾æ ‡ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ Plugin.cs            # æ’ä»¶å…¥å£ç±»ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ Services/            # è‡ªå®šä¹‰æœåŠ¡
â”œâ”€â”€ ViewModels/          # è§†å›¾æ¨¡å‹
â”œâ”€â”€ Views/               # è§†å›¾ï¼ˆé¡µé¢/çª—å£ï¼‰
â””â”€â”€ Models/              # æ•°æ®æ¨¡å‹
</code></pre>
<hr>
<h2 id="æ’ä»¶æ¸…å•æ–‡ä»¶">æ’ä»¶æ¸…å•æ–‡ä»¶</h2>
<h3 id="manifestyml-å­—æ®µè¯´æ˜">manifest.yml å­—æ®µè¯´æ˜</h3>
<table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>ç±»å‹</th>
<th>å¿…éœ€</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå»ºè®®ä½¿ç”¨åå‘åŸŸåæ ¼å¼</td>
</tr>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶æ˜¾ç¤ºåç§°</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶åŠŸèƒ½æè¿°</td>
</tr>
<tr>
<td><code>entranceAssembly</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶å…¥å£ç¨‹åºé›†æ–‡ä»¶åï¼ˆå« .dll åç¼€ï¼‰</td>
</tr>
<tr>
<td><code>url</code></td>
<td>string</td>
<td>âŒ</td>
<td>æ’ä»¶é¡¹ç›®ä¸»é¡µæˆ–ä»“åº“åœ°å€</td>
</tr>
<tr>
<td><code>version</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶ç‰ˆæœ¬å·ï¼ˆæ ¼å¼ï¼šmajor.minor.patch.buildï¼‰</td>
</tr>
<tr>
<td><code>apiVersion</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶ API ç‰ˆæœ¬ï¼Œå½“å‰å¿…é¡»ä¸ºÂ <code>2.0.0.0</code>Â æˆ–æ›´é«˜</td>
</tr>
<tr>
<td><code>author</code></td>
<td>string</td>
<td>âœ…</td>
<td>æ’ä»¶ä½œè€…åç§°</td>
</tr>
<tr>
<td><code>icon</code></td>
<td>string</td>
<td>âŒ</td>
<td>æ’ä»¶å›¾æ ‡æ–‡ä»¶åï¼ˆPNG æ ¼å¼ï¼Œæ¨èå°ºå¯¸ï¼š256x256ï¼‰</td>
</tr>
</tbody>
</table>
<h3 id="ç¤ºä¾‹">ç¤ºä¾‹</h3>
<pre><code class="lang-yaml">id: plfjy.ExamplePlugin
name: ExamplePlugin
description: ç¤ºä¾‹æ’ä»¶ã€‚
entranceAssembly: &quot;neo-bpsys-wpf.ExamplePlugin.dll&quot;
url: https://github.com/PLFJY/neo-bpsys-wpf
version: 1.0.0.0
apiVersion: 2.0.0.0
author: é›¶é£PLFJY
icon: icon.png
</code></pre>
<hr>
<h2 id="æ’ä»¶å…¥å£ç±»">æ’ä»¶å…¥å£ç±»</h2>
<p>æ’ä»¶å…¥å£ç±»å¿…é¡»ç»§æ‰¿Â <code>PluginBase</code>Â å¹¶å®ç°Â <code>Initialize</code>Â æ–¹æ³•ã€‚</p>
<h3 id="åŸºç¡€ç»“æ„">åŸºç¡€ç»“æ„</h3>
<pre><code class="lang-cs">using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using neo_bpsys_wpf.Core.Abstractions;

namespace YourPlugin;

public class Plugin : PluginBase
{
    public override void Initialize(HostBuilderContext context, IServiceCollection services)
    {
        // æ’ä»¶åˆå§‹åŒ–é€»è¾‘
    }
}
</code></pre>
<h3 id="å¯ç”¨å±æ€§">å¯ç”¨å±æ€§</h3>
<ul>
<li><p><strong><code>PluginConfigFolder</code></strong>:Â <code>string</code><br>
æ’ä»¶é…ç½®æ–‡ä»¶ç›®å½•è·¯å¾„ï¼Œæ’ä»¶çš„æ‰€æœ‰é…ç½®æ–‡ä»¶åº”ä¿å­˜åœ¨æ­¤ç›®å½•ä¸­ã€‚</p>
</li>
<li><p><strong><code>Info</code></strong>:Â <code>PluginInfo</code><br>
å½“å‰æ’ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯ï¼ˆåŒ…å«æ¸…å•ä¿¡æ¯ã€çŠ¶æ€ç­‰ï¼‰ã€‚</p>
</li>
</ul>
<hr>
<h2 id="æ’ä»¶èƒ½åŠ›">æ’ä»¶èƒ½åŠ›</h2>
<h3 id="æ³¨å†Œåå°ç®¡ç†é¡µé¢">æ³¨å†Œåå°ç®¡ç†é¡µé¢</h3>
<p>åå°ç®¡ç†é¡µé¢æ˜¾ç¤ºåœ¨ä¸»åº”ç”¨çš„è®¾ç½®ç•Œé¢ä¸­ï¼Œç”¨äºæ’ä»¶çš„é…ç½®å’Œç®¡ç†ã€‚</p>
<h4 id="1-åˆ›å»ºé¡µé¢å’Œ-viewmodel">1. åˆ›å»ºé¡µé¢å’Œ ViewModel</h4>
<pre><code class="lang-cs">// MainPage.xaml.cs
using System.Windows.Controls;
using neo_bpsys_wpf.Core.Attributes;
using Wpf.Ui.Controls;

namespace YourPlugin.Views;

[BackendPageInfo(
    &quot;unique-page-id&quot;,           // å”¯ä¸€ ID
    &quot;åå°é¡µé¢åç§°&quot;,              // æ˜¾ç¤ºåç§°
    SymbolRegular.Settings24,   // å›¾æ ‡
    BackendPageCategory.External // åˆ†ç±»
)]
public partial class MainPage : Page
{
    public MainPage()
    {
        InitializeComponent();
    }
}
</code></pre>
<pre><code class="lang-cs">// MainPageViewModel.cs
using CommunityToolkit.Mvvm.ComponentModel;

namespace YourPlugin.ViewModels;

public partial class MainPageViewModel : ObservableObject
{
    // ViewModel é€»è¾‘
}
</code></pre>
<h4 id="2-åœ¨æ’ä»¶å…¥å£æ³¨å†Œ">2. åœ¨æ’ä»¶å…¥å£æ³¨å†Œ</h4>
<pre><code class="lang-cs">using neo_bpsys_wpf.Core.Extensions.Registry;

public override void Initialize(HostBuilderContext context, IServiceCollection services)
{
    services.AddBackendPage&lt;MainPage, MainPageViewModel&gt;();
}
</code></pre>
<p>Tip</p>
<p><code>BackendPageCategory</code>Â æšä¸¾å€¼ï¼š</p>
<ul>
<li><code>External</code>: å¤–éƒ¨æ’ä»¶ï¼ˆé»˜è®¤ï¼‰</li>
<li><code>General</code>: å¸¸è§„è®¾ç½®</li>
<li><code>Advanced</code>: é«˜çº§è®¾ç½®</li>
</ul>
<hr>
<h3 id="æ³¨å†Œå‰å°å±•ç¤ºçª—å£">æ³¨å†Œå‰å°å±•ç¤ºçª—å£</h3>
<p>å‰å°å±•ç¤ºçª—å£ç”¨äºæ˜¾ç¤ºæ¯”èµ›æ•°æ®ã€OBS åœºæ™¯ç­‰å‰å°å†…å®¹ã€‚</p>
<h4 id="1-åˆ›å»ºçª—å£å’Œ-viewmodel">1. åˆ›å»ºçª—å£å’Œ ViewModel</h4>
<pre><code class="lang-cs">// MainWindow.xaml.cs
using neo_bpsys_wpf.Core.Attributes;
using neo_bpsys_wpf.Core.Controls;

namespace YourPlugin.Views;

[FrontedWindowInfo(
    &quot;unique-window-id&quot;,         // çª—å£å”¯ä¸€ ID
    &quot;å‰å°çª—å£åç§°&quot;,              // æ˜¾ç¤ºåç§°
    new[] {                     // ç”»å¸ƒå®šä¹‰ï¼ˆå¯é€‰ï¼‰
        &quot;BaseCanvas&quot;,           // åŸºç¡€ç”»å¸ƒï¼ˆé»˜è®¤ï¼‰
        &quot;CustomCanvas|è‡ªå®šä¹‰ç”»å¸ƒ&quot; // è‡ªå®šä¹‰ç”»å¸ƒï¼ˆæ ¼å¼ï¼šç”»å¸ƒå|æ˜¾ç¤ºåï¼‰
    }
)]
public partial class MainWindow : FrontedWindowBase
{
    public MainWindow()
    {
        InitializeComponent();
    }
}
</code></pre>
<pre><code class="lang-xml">&lt;!-- MainWindow.xaml --&gt;
&lt;controls:FrontedWindowBase
    x:Class=&quot;YourPlugin.Views.MainWindow&quot;
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    xmlns:controls=&quot;clr-namespace:neo_bpsys_wpf.Core.Controls;assembly=neo-bpsys-wpf.Core&quot;
    Title=&quot;MainWindow&quot;
    Width=&quot;800&quot;
    Height=&quot;450&quot;&gt;
    &lt;Canvas Name=&quot;BaseCanvas&quot; 
            Width=&quot;{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=Width}&quot;
            Height=&quot;{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=Height}&quot;&gt;
        &lt;!-- çª—å£å†…å®¹ --&gt;
    &lt;/Canvas&gt;
&lt;/controls:FrontedWindowBase&gt;
</code></pre>
<pre><code class="lang-cs">// MainWindowViewModel.cs
using neo_bpsys_wpf.Core.Abstractions;

namespace YourPlugin.ViewModels;

public partial class MainWindowViewModel : ViewModelBase
{
    // ViewModel é€»è¾‘
}
</code></pre>
<h4 id="2-åœ¨æ’ä»¶å…¥å£æ³¨å†Œ-1">2. åœ¨æ’ä»¶å…¥å£æ³¨å†Œ</h4>
<pre><code class="lang-cs">using neo_bpsys_wpf.Core.Extensions.Registry;

public override void Initialize(HostBuilderContext context, IServiceCollection services)
{
    services.AddFrontedWindow&lt;MainWindow, MainWindowViewModel&gt;();
}
</code></pre>
<p>Note</p>
<ul>
<li>å‰å°çª—å£å¿…é¡»ç»§æ‰¿Â <code>FrontedWindowBase</code></li>
<li>ViewModel å¿…é¡»ç»§æ‰¿Â <code>ViewModelBase</code></li>
<li>ç”»å¸ƒæ˜¯å¯é€‰çš„ï¼Œé»˜è®¤åŒ…å«Â <code>BaseCanvas</code></li>
</ul>
<hr>
<h3 id="æ³¨å…¥æ§ä»¶åˆ°ç°æœ‰çª—å£">æ³¨å…¥æ§ä»¶åˆ°ç°æœ‰çª—å£</h3>
<p>æ’ä»¶å¯ä»¥å°†è‡ªå®šä¹‰æ§ä»¶æ³¨å…¥åˆ°ä¸»åº”ç”¨çš„ç°æœ‰å‰å°çª—å£ä¸­ã€‚</p>
<h4 id="1-åˆ›å»ºæ§ä»¶">1. åˆ›å»ºæ§ä»¶</h4>
<pre><code class="lang-xml">&lt;!-- ExampleInjectedControl.xaml --&gt;
&lt;UserControl
    x:Class=&quot;YourPlugin.Views.ExampleInjectedControl&quot;
    xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;
    xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;
    Name=&quot;InjectedControl&quot;&gt;
    &lt;Grid&gt;
        &lt;TextBlock Name=&quot;MyText&quot; 
                   Text=&quot;æ³¨å…¥çš„æ§ä»¶&quot; 
                   FontSize=&quot;50&quot; /&gt;
    &lt;/Grid&gt;
&lt;/UserControl&gt;
</code></pre>
<pre><code class="lang-cs">// ExampleInjectedControl.xaml.cs
using System.Windows.Controls;

namespace YourPlugin.Views;

public partial class ExampleInjectedControl : UserControl
{
    public ExampleInjectedControl()
    {
        InitializeComponent();
    }
}
</code></pre>
<h4 id="2-åœ¨æ’ä»¶å…¥å£æ³¨å…¥">2. åœ¨æ’ä»¶å…¥å£æ³¨å…¥</h4>
<pre><code class="lang-cs">using neo_bpsys_wpf.Core.Helpers;
using neo_bpsys_wpf.Core.Enums;
using neo_bpsys_wpf.Core.Models;

public override void Initialize(HostBuilderContext context, IServiceCollection services)
{
    var control = new ExampleInjectedControl();
    
    FrontedWindowHelper.InjectControlToFrontedWindow(
        &quot;unique-control-id&quot;,                    // æ§ä»¶å”¯ä¸€ ID
        control,                                 // æ§ä»¶å®ä¾‹
        FrontedWindowType.BpWindow,             // ç›®æ ‡çª—å£ç±»å‹
        &quot;BaseCanvas&quot;,                           // ç›®æ ‡ç”»å¸ƒåç§°
        new ElementInfo(379, 100, 522, 312)     // é»˜è®¤ä½ç½®å’Œå°ºå¯¸ (X, Y, Width, Height)
    );
}
</code></pre>
<h4 id="å¯ç”¨çš„çª—å£ç±»å‹">å¯ç”¨çš„çª—å£ç±»å‹</h4>
<pre><code class="lang-cs">public enum FrontedWindowType
{
    BpWindow,              // BP çª—å£
    CutSceneWindow,        // è¿‡åœºçª—å£
    ScoreWindow,           // åˆ†æ•°çª—å£
    ScoreGlobalWindow,     // å…¨å±€åˆ†æ•°çª—å£
    ScoreHunWindow,        // ç›‘ç®¡è€…åˆ†æ•°çª—å£
    ScoreSurWindow,        // æ±‚ç”Ÿè€…åˆ†æ•°çª—å£
    GameDataWindow,        // æ¯”èµ›æ•°æ®çª—å£
    WidgetsWindow          // å°éƒ¨ä»¶çª—å£
}
</code></pre>
<div class="IMPORTANT">
<h5>Important</h5>
</div>
<p>æ³¨å…¥çš„æ§ä»¶å¯ä»¥åœ¨ä¸»åº”ç”¨çš„å‰å°çª—å£ç®¡ç†ç•Œé¢ä¸­æ‰‹åŠ¨è°ƒæ•´ä½ç½®å’Œå¤§å°ï¼Œè®¾ç½®ä¼šè‡ªåŠ¨ä¿å­˜ã€‚</p>
<hr>
<h3 id="æ³¨å†Œè‡ªå®šä¹‰æœåŠ¡">æ³¨å†Œè‡ªå®šä¹‰æœåŠ¡</h3>
<p>æ’ä»¶å¯ä»¥æ³¨å†Œè‡ªå·±çš„æœåŠ¡åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ã€‚</p>
<h4 id="1-åˆ›å»ºæœåŠ¡æ¥å£å’Œå®ç°">1. åˆ›å»ºæœåŠ¡æ¥å£å’Œå®ç°</h4>
<pre><code class="lang-cs">// IExampleService.cs
namespace YourPlugin.Services;

public interface IExampleService
{
    void DoSomething();
}
</code></pre>
<pre><code class="lang-cs">// ExampleService.cs
namespace YourPlugin.Services;

public class ExampleService : IExampleService
{
    public void DoSomething()
    {
        // æœåŠ¡é€»è¾‘
    }
}
</code></pre>
<h4 id="2-åœ¨æ’ä»¶å…¥å£æ³¨å†Œ-2">2. åœ¨æ’ä»¶å…¥å£æ³¨å†Œ</h4>
<pre><code class="lang-cs">public override void Initialize(HostBuilderContext context, IServiceCollection services)
{
    services.AddSingleton&lt;IExampleService, ExampleService&gt;();
}
</code></pre>
<h4 id="3-åœ¨-viewmodel-ä¸­ä½¿ç”¨">3. åœ¨ ViewModel ä¸­ä½¿ç”¨</h4>
<pre><code class="lang-cs">using Microsoft.Extensions.DependencyInjection;

public partial class MainPageViewModel : ObservableObject
{
    private readonly IExampleService _exampleService;
    
    public MainPageViewModel(IExampleService exampleService)
    {
        _exampleService = exampleService;
    }
}
</code></pre>
<hr>
<h3 id="é…ç½®æ–‡ä»¶ç®¡ç†">é…ç½®æ–‡ä»¶ç®¡ç†</h3>
<p>æ’ä»¶å¯ä»¥ä½¿ç”¨Â <code>ConfigureFileHelper</code>Â æ–¹ä¾¿åœ°ç®¡ç†é…ç½®æ–‡ä»¶ã€‚</p>
<h4 id="1-åˆ›å»ºé…ç½®ç±»">1. åˆ›å»ºé…ç½®ç±»</h4>
<pre><code class="lang-cs">using CommunityToolkit.Mvvm.ComponentModel;

namespace YourPlugin.Models;

public partial class PluginSettings : ObservableObject
{
    [ObservableProperty]
    private string _settingValue = &quot;é»˜è®¤å€¼&quot;;
    
    [ObservableProperty]
    private int _counter = 0;
}
</code></pre>
<h4 id="2-åŠ è½½å’Œä¿å­˜é…ç½®">2. åŠ è½½å’Œä¿å­˜é…ç½®</h4>
<pre><code class="lang-cs">using System.IO;
using neo_bpsys_wpf.Core.Helpers;

public class Plugin : PluginBase
{
    public PluginSettings Settings { get; set; } = new();
    
    public override void Initialize(HostBuilderContext context, IServiceCollection services)
    {
        // åŠ è½½é…ç½®æ–‡ä»¶
        Settings = ConfigureFileHelper.LoadConfig&lt;PluginSettings&gt;(
            Path.Combine(PluginConfigFolder, &quot;Settings.json&quot;)
        );
        
        // ç›‘å¬å±æ€§å˜åŒ–å¹¶è‡ªåŠ¨ä¿å­˜
        Settings.PropertyChanged += (sender, args) =&gt;
        {
            ConfigureFileHelper.SaveConfig(
                Path.Combine(PluginConfigFolder, &quot;Settings.json&quot;), 
                Settings
            );
        };
    }
}
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<ul>
<li>é…ç½®æ–‡ä»¶ä¼šè‡ªåŠ¨ä¿å­˜ä¸º JSON æ ¼å¼</li>
<li>æ¨èå°†é…ç½®æ–‡ä»¶ä¿å­˜åœ¨Â <code>PluginConfigFolder</code>Â ç›®å½•ä¸­</li>
<li>ä½¿ç”¨Â <code>ObservableObject</code>Â å¯ä»¥è‡ªåŠ¨è§¦å‘å±æ€§å˜åŒ–é€šçŸ¥</li>
</ul>
</div>
<hr>
<h3 id="è®¿é—®å…±äº«æ•°æ®">è®¿é—®å…±äº«æ•°æ®</h3>
<p>æ’ä»¶å¯ä»¥é€šè¿‡Â <code>ISharedDataService</code>Â è®¿é—®å’Œä¿®æ”¹ä¸»åº”ç”¨çš„å„ç§æ•°æ®å®ä¾‹</p>
<h4 id="è·å–æœåŠ¡å®ä¾‹">è·å–æœåŠ¡å®ä¾‹</h4>
<pre><code class="lang-cs">using neo_bpsys_wpf.Core.Abstractions.Services;

public partial class MainPageViewModel : ObservableObject
{
    private readonly ISharedDataService _sharedDataService;
    
    public MainPageViewModel(ISharedDataService sharedDataService)
    {
        _sharedDataService = sharedDataService;
    }
}
</code></pre>
<h4 id="å¯ç”¨çš„æ•°æ®å’Œæ–¹æ³•">å¯ç”¨çš„æ•°æ®å’Œæ–¹æ³•</h4>
<h5 id="é˜Ÿä¼æ•°æ®">é˜Ÿä¼æ•°æ®</h5>
<pre><code class="lang-cs">// ä¸»é˜Ÿ
Team mainTeam = _sharedDataService.MainTeam;
_sharedDataService.MainTeam = newMainTeam;

// å®¢é˜Ÿ
Team awayTeam = _sharedDataService.AwayTeam;
_sharedDataService.AwayTeam = newAwayTeam;
</code></pre>
<h5 id="å¯¹å±€æ•°æ®">å¯¹å±€æ•°æ®</h5>
<pre><code class="lang-cs">// å½“å‰å¯¹å±€
Game currentGame = _sharedDataService.CurrentGame;
// æ–°å»ºå¯¹å±€
_sharedDataService.NewGame();
</code></pre>
<h5 id="è§’è‰²å­—å…¸">è§’è‰²å­—å…¸</h5>
<pre><code class="lang-cs">// æ±‚ç”Ÿè€…è§’è‰²å­—å…¸
SortedDictionary&lt;string, Character&gt; surCharaDict = _sharedDataService.SurCharaDict;

// ç›‘ç®¡è€…è§’è‰²å­—å…¸
SortedDictionary&lt;string, Character&gt; hunCharaDict = _sharedDataService.HunCharaDict;
</code></pre>
<h5 id="ban-ä½ç®¡ç†">Ban ä½ç®¡ç†</h5>
<pre><code class="lang-cs">// è®¾ç½® Ban ä½æ•°é‡
_sharedDataService.SetBanCount(BanListName.CurrentSurBanned, 3);
_sharedDataService.SetBanCount(BanListName.CurrentHunBanned, 2);

// Ban ä½å¯ç”¨çŠ¶æ€åˆ—è¡¨
ObservableCollection&lt;bool&gt; canCurrentSurBannedList = _sharedDataService.CanCurrentSurBannedList;
ObservableCollection&lt;bool&gt; canCurrentHunBannedList = _sharedDataService.CanCurrentHunBannedList;
ObservableCollection&lt;bool&gt; canGlobalSurBannedList = _sharedDataService.CanGlobalSurBannedList;
ObservableCollection&lt;bool&gt; canGlobalHunBannedList = _sharedDataService.CanGlobalHunBannedList;
</code></pre>
<h5 id="å€’è®¡æ—¶æ§åˆ¶">å€’è®¡æ—¶æ§åˆ¶</h5>
<pre><code class="lang-cs">// å¼€å§‹å€’è®¡æ—¶ï¼ˆç§’ï¼‰
_sharedDataService.TimerStart(60);

// åœæ­¢å€’è®¡æ—¶
_sharedDataService.TimerStop();

// è·å–å‰©ä½™ç§’æ•°
string remainingSeconds = _sharedDataService.RemainingSeconds;
</code></pre>
<h5 id="å…¶ä»–è®¾ç½®">å…¶ä»–è®¾ç½®</h5>
<pre><code class="lang-cs">// è¾…åŠ©ç‰¹è´¨å¯è§æ€§
bool isTraitVisible = _sharedDataService.IsTraitVisible;
_sharedDataService.IsTraitVisible = true;

// BO3 æ¨¡å¼
bool isBo3Mode = _sharedDataService.IsBo3Mode;
_sharedDataService.IsBo3Mode = false;

// åœ°å›¾ V2 å‘¼å¸ç¯
bool isMapV2Breathing = _sharedDataService.IsMapV2Breathing;
_sharedDataService.IsMapV2Breathing = true;

// åœ°å›¾ V2 é˜µè¥å¯è§æ€§
bool isMapV2CampVisible = _sharedDataService.IsMapV2CampVisible;
_sharedDataService.IsMapV2CampVisible = false;
</code></pre>
<h5 id="äº‹ä»¶è®¢é˜…">äº‹ä»¶è®¢é˜…</h5>
<pre><code class="lang-cs">// è®¢é˜…æ•°æ®å˜åŒ–äº‹ä»¶
_sharedDataService.CurrentGameChanged += OnCurrentGameChanged;
_sharedDataService.BanCountChanged += OnBanCountChanged;
_sharedDataService.IsTraitVisibleChanged += OnIsTraitVisibleChanged;
_sharedDataService.IsBo3ModeChanged += OnIsBo3ModeChanged;
_sharedDataService.CountDownValueChanged += OnCountDownValueChanged;
_sharedDataService.TeamSwapped += OnTeamSwapped;
_sharedDataService.IsMapV2BreathingChanged += OnIsMapV2BreathingChanged;
_sharedDataService.IsMapV2CampVisibleChanged += OnIsMapV2CampVisibleChanged;

private void OnCurrentGameChanged(object? sender, EventArgs e)
{
    // å¤„ç†å¯¹å±€å˜åŒ–
}
</code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>ç”±äºä¸»åº”ç”¨ä½¿ç”¨æ•°æ®ç»‘å®šï¼Œå½“æ‚¨ä¿®æ”¹Â <code>ISharedDataService</code>Â ä¸­çš„æ•°æ®æ—¶ï¼Œå‰å°ç•Œé¢ä¼šè‡ªåŠ¨åŒæ­¥æ›´æ–°ï¼ä½ æ— éœ€æ‹…å¿ƒæ•°æ®å˜æ›´çš„åç»­æ“ä½œ</p>
</div>
<hr>
<h2 id="å¼€å‘ç¯å¢ƒè®¾ç½®">å¼€å‘ç¯å¢ƒè®¾ç½®</h2>
<h3 id="1-å¼•ç”¨-pluginsdk">1. å¼•ç”¨ PluginSdk</h3>
<p>åœ¨é¡¹ç›®æ–‡ä»¶ (.csproj) ä¸­æ·»åŠ ï¼š</p>
<pre><code class="lang-xml">&lt;ItemGroup&gt;
  &lt;PackageReference Include=&quot;neo-bpsys-wpf.PluginSdk&quot; Version=&quot;2.0.0&quot; /&gt;
&lt;/ItemGroup&gt;
</code></pre>
<h3 id="2-é…ç½®è¾“å‡º">2. é…ç½®è¾“å‡º</h3>
<p>ç¡®ä¿Â <code>manifest.yml</code>Â å’Œå›¾æ ‡æ–‡ä»¶è¢«å¤åˆ¶åˆ°è¾“å‡ºç›®å½•ï¼š</p>
<pre><code class="lang-xml">&lt;ItemGroup&gt;
  &lt;None Update=&quot;manifest.yml&quot;&gt;
    &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;
  &lt;/None&gt;
  &lt;None Update=&quot;icon.png&quot;&gt;
    &lt;CopyToOutputDirectory&gt;PreserveNewest&lt;/CopyToOutputDirectory&gt;
  &lt;/None&gt;
&lt;/ItemGroup&gt;
</code></pre>
<h3 id="3-è°ƒè¯•æ’ä»¶">3. è°ƒè¯•æ’ä»¶</h3>
<ul>
<li>åœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ„å»ºæ’ä»¶</li>
<li>å°†è¾“å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ°ä¸»åº”ç”¨çš„Â <code>Plugins/YourPluginId</code>Â æ–‡ä»¶å¤¹</li>
<li>å¯åŠ¨ä¸»åº”ç”¨è¿›è¡Œæµ‹è¯•</li>
</ul>
<hr>
<h2 id="æ‰“åŒ…ä¸å‘å¸ƒ">æ‰“åŒ…ä¸å‘å¸ƒ</h2>
<h3 id="ä½¿ç”¨-pluginpack-è‡ªåŠ¨æ‰“åŒ…">ä½¿ç”¨ PluginPack è‡ªåŠ¨æ‰“åŒ…</h3>
<p>åœ¨é¡¹ç›®ç›®å½•è¿è¡Œï¼š</p>
<pre><code class="lang-shell">dotnet publish -p:PluginPack=true
</code></pre>
<p>è¿™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å¿…éœ€æ–‡ä»¶çš„æ’ä»¶åŒ…ï¼Œå¯ä»¥ç›´æ¥åœ¨æ’ä»¶é¡µé¢å¯¼å…¥å®ƒï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ä¼šåˆ›å»ºï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œå¯ä»¥è‡ªè¡Œå» publish çš„ç›®å½•æ‹¿äº§ç‰©æ‰“åŒ…æˆ zip</p>
<h3 id="æ‰‹åŠ¨æ‰“åŒ…">æ‰‹åŠ¨æ‰“åŒ…</h3>
<ol>
<li>æ„å»ºé¡¹ç›®ï¼ˆRelease é…ç½®ï¼‰</li>
<li>ä»è¾“å‡ºç›®å½•æ”¶é›†ä»¥ä¸‹æ–‡ä»¶ï¼š
<ul>
<li>æ’ä»¶ DLL æ–‡ä»¶</li>
<li><code>manifest.yml</code></li>
<li><code>icon.png</code>ï¼ˆå¦‚æœæœ‰ï¼‰</li>
<li>æ‰€æœ‰ä¾èµ–çš„ DLLï¼ˆä¸åŒ…æ‹¬ PluginSdk å’Œä¸»åº”ç”¨å·²æœ‰çš„ä¾èµ–ï¼‰</li>
</ul>
</li>
<li>å°†è¿™äº›æ–‡ä»¶æ”¾å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹åä¸ºæ’ä»¶ ID</li>
<li>å‹ç¼©æˆ ZIP æ–‡ä»¶è¿›è¡Œåˆ†å‘</li>
</ol>
<h3 id="å®‰è£…æ’ä»¶">å®‰è£…æ’ä»¶</h3>
<p>ç›´æ¥åœ¨æ’ä»¶é¡µé¢ä»æ–‡ä»¶åŒ…å¯¼å…¥æ’ä»¶å³å¯</p>
<hr>
<h2 id="ç¤ºä¾‹æ’ä»¶">ç¤ºä¾‹æ’ä»¶</h2>
<h3 id="exampleplugin---å®Œæ•´åŠŸèƒ½ç¤ºä¾‹">ExamplePlugin - å®Œæ•´åŠŸèƒ½ç¤ºä¾‹</h3>
<p>ä½ç½®:Â <code>neo-bpsys-wpf.ExamplePlugin</code></p>
<p>å±•ç¤ºäº†æ’ä»¶çš„æ‰€æœ‰èƒ½åŠ›ï¼š</p>
<ul>
<li>âœ… åå°ç®¡ç†é¡µé¢</li>
<li>âœ… å‰å°å±•ç¤ºçª—å£</li>
<li>âœ… æ§ä»¶æ³¨å…¥</li>
<li>âœ… è‡ªå®šä¹‰æœåŠ¡</li>
<li>âœ… é…ç½®æ–‡ä»¶ç®¡ç†</li>
</ul>
<pre><code class="lang-cs">using System.IO;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using neo_bpsys_wpf.Core.Abstractions;
using neo_bpsys_wpf.Core.Enums;
using neo_bpsys_wpf.Core.Extensions.Registry;
using neo_bpsys_wpf.Core.Helpers;
using neo_bpsys_wpf.Core.Models;
using neo_bpsys_wpf.ExamplePlugin.Models;
using neo_bpsys_wpf.ExamplePlugin.Services;
using neo_bpsys_wpf.ExamplePlugin.Views;

namespace neo_bpsys_wpf.ExamplePlugin;

public class ExamplePlugin : PluginBase
{
    public PluginSettings Settings { get; set; } = new();

    public override void Initialize(HostBuilderContext context, IServiceCollection services)
    {
        // æ³¨å†Œåå°é¡µé¢
        services.AddBackendPage&lt;MainPage, ViewModels.MainPageViewModel&gt;();
            
        // æ³¨å†Œå‰å°çª—å£
        services.AddFrontedWindow&lt;MainWindow, ViewModels.MainWindowViewModel&gt;();
            
        // æ³¨å†ŒæœåŠ¡
        services.AddSingleton&lt;IExampleService, ExampleService&gt;();
            
        // æ³¨å†Œæ³¨å…¥æ§ä»¶
        ExampleInjectedControl injectedControl = new();
        FrontedWindowHelper.InjectControlToFrontedWindow(
            &quot;D9AFD731-DB3C-408B-8368-D70E688CE7CB&quot;,
            injectedControl, 
            FrontedWindowType.BpWindow, 
            &quot;BaseCanvas&quot;,
            new ElementInfo(379, 100, 522, 312)
        );

        // åŠ è½½é…ç½®æ–‡ä»¶
        Settings = ConfigureFileHelper.LoadConfig&lt;PluginSettings&gt;(
            Path.Combine(PluginConfigFolder, &quot;Settings.json&quot;)
        );
        
        // ç›‘å¬å±æ€§å˜åŒ–
        Settings.PropertyChanged += (sender, args) =&gt;
        {
            ConfigureFileHelper.SaveConfig(
                Path.Combine(PluginConfigFolder, &quot;Settings.json&quot;), 
                Settings
            );
        };
    }
}
</code></pre>
<h3 id="teamjsonmaker---ç®€å•æ’ä»¶ç¤ºä¾‹">TeamJsonMaker - ç®€å•æ’ä»¶ç¤ºä¾‹</h3>
<p>ä½ç½®:Â <code>neo-bpsys-wpf.TeamJsonMaker</code></p>
<p>ä¸€ä¸ªç®€å•çš„æ’ä»¶ï¼Œä»…åŒ…å«ä¸€ä¸ªåå°é¡µé¢ï¼š</p>
<pre><code class="lang-cs">using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using neo_bpsys_wpf.Core.Abstractions;
using neo_bpsys_wpf.Core.Extensions.Registry;

namespace neo_bpsys_wpf.TeamJsonMaker;

public class Plugin : PluginBase
{
    public override void Initialize(HostBuilderContext context, IServiceCollection services)
    {
        services.AddBackendPage&lt;TeamJsonMaker, TeamJsonMakerViewModel&gt;();
    }
}
</code></pre>
<hr>
<h2 id="å¸¸è§é—®é¢˜">å¸¸è§é—®é¢˜</h2>
<h3 id="q-æ’ä»¶-api-ç‰ˆæœ¬è¦æ±‚æ˜¯ä»€ä¹ˆ">Q: æ’ä»¶ API ç‰ˆæœ¬è¦æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>A: å½“å‰æ’ä»¶ API ç‰ˆæœ¬å¿…é¡»ä¸ºÂ <code>2.0.0.0</code>Â æˆ–æ›´é«˜ã€‚ä½äºæ­¤ç‰ˆæœ¬çš„æ’ä»¶å°†æ— æ³•åŠ è½½ã€‚</p>
<h3 id="q-å¦‚ä½•åœ¨æ’ä»¶ä¹‹é—´å…±äº«æ•°æ®">Q: å¦‚ä½•åœ¨æ’ä»¶ä¹‹é—´å…±äº«æ•°æ®ï¼Ÿ</h3>
<p>A: æ¨èä½¿ç”¨ä¸»åº”ç”¨çš„Â <code>ISharedDataService</code>Â æˆ–åˆ›å»ºè‡ªå·±çš„æœåŠ¡å¹¶æ³¨å†Œä¸ºå•ä¾‹ã€‚</p>
<h3 id="q-æ’ä»¶å¯ä»¥è®¿é—®ä¸»åº”ç”¨çš„å“ªäº›èµ„æº">Q: æ’ä»¶å¯ä»¥è®¿é—®ä¸»åº”ç”¨çš„å“ªäº›èµ„æºï¼Ÿ</h3>
<p>A: æ’ä»¶å¯ä»¥è®¿é—®ï¼š</p>
<ul>
<li><code>ISharedDataService</code>Â ä¸­çš„æ‰€æœ‰å…±äº«æ•°æ®</li>
<li>ä¸»åº”ç”¨æ³¨å†Œçš„æ‰€æœ‰æœåŠ¡</li>
<li>å‰å°çª—å£çš„ç”»å¸ƒç”¨äºæ§ä»¶æ³¨å…¥</li>
</ul>
<h3 id="q-å¦‚ä½•è°ƒè¯•æ’ä»¶">Q: å¦‚ä½•è°ƒè¯•æ’ä»¶ï¼Ÿ</h3>
<p>A: å»ºè®®å°†æ’ä»¶æ„å»ºè¾“å‡ºå¤åˆ¶åˆ°ä¸»åº”ç”¨çš„ Plugins æ–‡ä»¶å¤¹ï¼Œç„¶åä½¿ç”¨&quot;é™„åŠ åˆ°è¿›ç¨‹&quot;è°ƒè¯•ä¸»åº”ç”¨ã€‚</p>
<h3 id="q-æ’ä»¶å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹-nuget-åŒ…å—">Q: æ’ä»¶å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ NuGet åŒ…å—ï¼Ÿ</h3>
<p>A: å¯ä»¥ï¼Œä½†è¯·ç¡®ä¿åœ¨æ‰“åŒ…æ—¶åŒ…å«æ‰€æœ‰ä¾èµ–çš„ DLL æ–‡ä»¶ã€‚</p>
<hr>
<h2 id="æŠ€æœ¯æ”¯æŒ">æŠ€æœ¯æ”¯æŒ</h2>
<p>å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è®¿é—®ï¼š</p>
<ul>
<li>GitHub ä»“åº“:Â <a href="https://github.com/PLFJY/neo-bpsys-wpf">https://github.com/PLFJY/neo-bpsys-wpf</a></li>
<li>æäº¤ Issue:Â <a href="https://github.com/PLFJY/neo-bpsys-wpf/issues">https://github.com/PLFJY/neo-bpsys-wpf/issues</a></li>
</ul>
<hr>
<p><strong>ç¥æ‚¨å¼€å‘æ„‰å¿«ï¼</strong>Â ğŸ‰</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/PLFJY/neo-bpsys-docs/blob/master/docs/å¼€å‘æ–‡æ¡£/æ’ä»¶å¼€å‘æ–‡æ¡£.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
